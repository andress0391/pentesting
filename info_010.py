#!/usr/env/ python
# -*- encoding: utf-8 -*-

import os


class Info:
    def __init__(self):
        """
        Esta sección se enfoca principalmente en mapear la arquitectura
        de la aplicación que se encuentra desplegada para identificar
        los dispositivos intermedios que se encuentra entre el cliente y el servidor
        """

    def scanner(self, dirIP):
        print("Escaneando puertos ...")
        os.system("nmap -f --mtu 24 " + dirIP + "> Salida/info_010_pscan.txt")
        print("Detectando infraestructura ...")
        os.system("nmap -f --mtu 24 -A " + dirIP + "> Salida/info_010_infra.txt")
        print("Detectando servidores ...")
        os.system("nmap -f -Pn --script discovery " + dirIP + "> Salida/info_010_server.txt")
        print("Detectando vulnerabilidades ...")
        os.system("nmap -f --mtu 24 -P0 --script vuln " + dirIP + "> Salida/info_010_vuln.txt")
        print("Detectando puerto NTP ...")
        os.system("nmap -sU -pU:123 -P0 -n --script=ntp-monlist " + dirIP + "> Salida/info_010_ntp.txt")
