# usr/bin/env
# -*- coding: utf-8 -*-


import sys
from info_010 import Info
from domine import Dominio
#from folder_info_007.info_007 import Info_007
sys.path.append("./folder_info_007")
sys.path.append("./SQL_XSS")
from info_007 import Info_007
from sql import Invpal_005
from xss import Invpal_001



class Facade:
	"""Controlador de PoC"""

	def __init__(self,url):
		self.url = url
		self.obj_domine = Dominio(self.url)
		self.obj_nmap = Info()
		self.obj_info_007 = Info_007()
		self.obj_invpal_005 = Invpal_005()
		self.obj_invpal_001 = Invpal_001()
		#self.dir_ip = self.obj_domine.obtener_dir_ip()

	def get_ip(self):
		"""Obtener la direccion IP de la URL o dominio"""
		global dir_ip 
		dir_ip = self.obj_domine.obtener_dir_ip()
		print("La dirección IP es : " + dir_ip)

	def port_scan(self):
		"Escanear  puertos del target para OTG-INFO-010"
		#print("-----PORT SCANING-----")
		self.obj_nmap.scanner(dir_ip)

	def crawling(self):
		"""Spidering del sitio web para OTG-INFO-007"""
		print("-----SPIDERING------")
		self.obj_info_007.spidering(self.url)

	def sql(self):
		"""Sql injection para OTG-INVPAL-005"""
		print("-----SQL INJECTION------")
		self.obj_invpal_005.sql_injection(self.url)

	def xss(self):
		"""XSS cross site scripting para OTG-INVPAL-001"""
		print("-----CROSS SITE SCRIPTING------")
		self.obj_invpal_001.xss_reflejado(self.url)


	def main(self):
		cont = Facade(self.url)
		print("-----RECOPILACIÓN DE INFORMACIÓN-----")
		cont.get_ip()
		cont.port_scan()
		cont.crawling()
		cont.sql()
		cont.xss()


#if __name__ == '__main__':
#	main()


