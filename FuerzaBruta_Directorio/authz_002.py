#!/usr/bin/python3
# -*- encoding: utf-8 -*-

import requests
from urllib.parse import urlparse

archivo = "acl.txt"

codigos_estado = {200: 'OK', 204: 'No content', 301: 'Moved Permanently',
                  302: 'Found', 307: 'Temporary Redirect', 401: 'Unauthorized',
                  403: 'Forbidden'}

extensiones = ['.asp', '.aspx', '.html', '.htm', '.xhtml', '.php',
               '.jsf', '.sh', '.txt', '.css', '.old', '.bak', '.htaccess']


def mensjaeInicio(url):
    print("======================================================================")
    print("| ULR/Dominio  : %s" % url)
    print("| Códigos HTTP : ", end='', flush=True)
    for i in codigos_estado.keys():
        print(str(i) + " ", end='', flush=True)
    print("\n| Extensiones  : ", end='', flush=True)
    for i in extensiones:
        print(i + " ", end='', flush=True)
    print("\n======================================================================")


def informacionDir(r, url, l):
    u = url + l
    print(u + " (" + str(r.status_code) + ")")


def informacionArch(r, url, l, i):
    u = url + l + i
    print(u + " (" + str(r.status_code) + ") ")


def prueba(url):
    r = None
    with open(archivo, 'r') as f:
        while True:
            linea = f.readline()
            if linea == "":
                break
            linea = linea[0:-1]
            # Peticion directorio
            r = requests.head(url + linea)
            if r.status_code in codigos_estado:
                informacionDir(r, url, linea)
            # Petición archivo
            for i in extensiones:
                r = requests.head(url + linea + i)
                if r.status_code in codigos_estado:
                    informacionArch(r, url, linea, i)
    f.close()


def main(url):
    u = urlparse(url)
    url = u.scheme + "://" + u.netloc + u.path
    target = u.scheme + "://" + u.netloc + "/"
    mensjaeInicio(target)
    prueba(target)


url = "http://190.5.199.22:8082"
main(url)
