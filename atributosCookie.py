#!/usr/bin/python3
# -*- encoding: utf-8 -*-

# import requests
# import mechanicalsoup
import re
# from urllib.parse import urlparse

# r = requests.head("http://190.5.199.22:8082/RegistroSiag/Default.aspx")
# print(r.headers)

respuestaPrueba = {'Cache-Control': 'private',
                   'Content-Length': '192',
                   'Content-Type': 'text/html; charset=utf-8',
                   'Location': '/RegistroSiag/Account/wfLogin.aspx?ReturnUrl=%2fRegistroSiag%2fDefault.aspx',
                   'Server': 'Microsoft-IIS/7.0',
                   'Cookie': 'cookie vlue; path=/; HttpOnly; secure; domain=.aa.com',
                   'X-AspNet-Version': '4.0.30319',
                   'X-Powered-By': 'ASP.NET',
                   'Date': 'Thu, 29 Mar 2018 21:02:50 GMT'}


def getAtributos():
    '''
    Obtener atributos de la cookie
    '''
    atributosTmp = ""
    atributosCookie = ""
    try:
        atributosTmp = respuestaPrueba['Cookie']
        atributosCookie = atributosTmp.split("; ")
        return atributosCookie
    except KeyError as e:
        return -1


def adaptarAttPath(atributo):
    print(atributo.split("="))


def adaptarAttDomain(atributo):
    pass


def inspeccionarAtributos(atributosCookie):
    '''
    Documentaci√≥n...
    '''
    atributos = ['secure', 'HttpOnly', 'domain', 'path']
    expresionPath = re.compile("path=*")
    expresionDomain = re.compile("domain=*")

    print(atributosCookie)
    for i in atributosCookie:
        exMatchPath = expresionPath.match(i)
        exMatchDom = expresionDomain.match(i)
        if exMatchPath is not None:
            adaptarAttPath(i)
        elif exMatchDom is not None:
            adaptarAttDomain(i)


'''
session = requests.Session()
session.cookies.set('ASP.NET_SessionId', 'jzzrcm2brlmhysrsq5ohrbpx')
session.cookies.set('.ASPAUTH', '')
browser = mechanicalsoup.StatefulBrowser(session=session)

a = browser.open("http://190.5.199.22:8082/RegistroSiag/Account/wfLogin.aspx")

browser.select_form('form[action="./wfLogin.aspx"]')
browser["rblInformacion"] = "Si"
browser.submit_selected()
browser.select_form('form[action="./wfLogin.aspx"]')
browser["txtPin"] = "242882"
browser.submit_selected()
print(browser.get_current_page())
browser.select_form('form[action="./wfLogin.aspx"]')
browser["txtDocumento"] = "123456789"
browser["txtCDocumento"] = "123456789"
browser["ddlPrograma"] = "1"
browser.submit_selected()
'''

# print(browser.get_current_page())
atributosCookie = getAtributos()
inspeccionarAtributos(atributosCookie)
