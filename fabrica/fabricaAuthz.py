#!/usr/bin/python3
# -*- encoding: utf-8 -*-

import os
import socket
from urllib.parse import urlparse
from .fabrica import Fabrica
from src.authorization.authz_003.authz_003 import AUTHZ_003
from src.authorization.authz_004 import AUTHZ_004

class FabAuthz(Fabrica):
    def __init__(self, url, usuarioPrueba=list()):
        super().__init__(url, usuarioPrueba)
    
    def obtenerProcesos(self, riesgoNegocio=0.0):
        procesos = list()
        if self.check_url(self.url) > 0: 
            procesos.append(AUTHZ_003(self.url, riesgoNegocio=riesgoNegocio))
        else:
            ip = self.obtenerIP()
            procesos.append(AUTHZ_003(ip, riesgoNegocio=riesgoNegocio))
        #procesos.append(AUTHZ_004(self.url))
        return procesos
        
    
    def obtenerIP(self):
        u = urlparse(self.url)
        url = u.netloc
        return socket.gethostbyname(url)

    def check_url(self,url):
        tmp = str(url[0])
        tmp_2 = str(url[-1])
        if (tmp.isnumeric() and tmp_2.isnumeric()):
            return 1
        else:
            return -1
    
   
        
    
   
        
        
        
        
