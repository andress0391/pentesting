import requests
import sys
import os


'''Retorna el código fuente HTML de la URL en busca 
    de informaicón sensible en los metadatos
   :parámetro url: dirección del sitio web a revisar'''
    
def download(url):
    print ("Revisando metadatos ...")  
    r = requests.get(url)
    if r.status_code != 200:
        sys.stderr.write("!Error {} recuperando {} ".format(r.status_code, url))
        return None

    return r.text
    

'''Descarga la el sitio web con el comando wget y busca 
    los comentarios con la opción grep'''

def comentarios(url):
    print ("Analizando comentarios ...")
    os.system("wget -q "+ url+ " -O page")
    os.system("grep '<!-' page")


if __name__ == '__main__':
    url = "http://190.5.199.22:8082/RegistroSiag"
    comentarios(url)
    r = download(url)
    if r:
        sys.stdout.write(r[:200])
    else:
        sys.stdout.write("No fue posible recuperar el sitio web\n")

    