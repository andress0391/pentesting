import requests
import os


class Invpal_001:

    def __init__(self):
        """XSS REFLECTED"""
        print("")

    def xss_reflejado(self,url):
        #url = input("URL:") 
        os.chdir("SQL_XSS")
        fname = "payloads_xss.txt"
        with open(fname) as f:
            content = f.readlines()    
        payloads = [x.strip() for x in content]
        #return payloads
              
        vuln = []
        #payloads=self.loadPayload()
        for payload in payloads:
            payload = payload
            if url[-1] != "/":
                url = url + "/"
            else:
                xss_url = url+payload
                print(xss_url)
                r = requests.get(xss_url)
                if payload.lower() in r.text.lower():
                    print("Vulnerable: " + payload)
                    if(payload not in vuln):
                        vuln.append(payload)
                else:
                    print("Not vulnerable!")

    def main(self):
        #url="https://www.peabody.harvard.edu/"
        #url = "https://code.visualstudio.com/docs/?dv="
        #url = "http://190.5.199.22:8082/RegistroSiag/"
        self.xss_reflejado(url)
        print("--------------------\nAvailable Payloads:")
        #print('\n'.join(vuln))

#objxss = Invpal_001()
#objxss.main()
