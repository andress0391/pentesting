import sys
import os
import urllib.request
from fabrica.otg import OTG
from src.input_validation.Input_validation_testing.inpval_005_template import Inpval_005_template

__otg__ = "OTG-INPVAL-005"

class Invpal_005_Oracle(OTG):

    def __init__(self, url,dependencia=None,riesgoNegocio=0.0):
        super().__init__(dependencia, __otg__,riesgoNegocio)
        self.url = url

    def sql_injection(self):
        obj = Inpval_005_template(self.url)
        msg_error = "ORA-00933: SQL command not properly ended"
        msg_tech = "Oracle"
        payload = "payload_oracle.txt"
        obj.injection(self.url,msg_error,msg_tech,payload)


    def main(self):
        print("================ Iniciando prueba OTG-INPVAL-005-ORACLE ==================\n")
        self.sql_injection()
        print("================ Fin prueba OTG-INPVAL-005-ORACLE ==================\n")
    	# url = "http://www.tunesoman.com/product.php?id="
    	# sql(url)

        