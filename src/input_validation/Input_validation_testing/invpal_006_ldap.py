import requests
import os
from fabrica.otg import OTG
from src.input_validation.Input_validation_testing.inpval_005_template import Inpval_005_template

__otg__ = "OTG-INPVAL-005"

class Invpal_006(OTG):

    def __init__(self, url,dependencia=None):
        super().__init__(dependencia, __otg__)
        self.url = url

    def sql_injection(self):
        obj = Inpval_005_template(self.url)
        msg_error = "You have an error in your SQL syntax"
        msg_tech = "MySQL"
        payload = "payload.txt"
        obj.injection(self.url,msg_error,msg_tech,payload)


    def main(self):
        #url="https://www.peabody.harvard.edu/"
        #url = "https://code.visualstudio.com/docs/?dv="
        #url = "http://190.5.199.22:8082/RegistroSiag/"
        self.xss_reflejado(url)
        print("--------------------\nAvailable Payloads:")
        #print('\n'.join(vuln))

#objxss = Invpal_001()
#objxss.main()
