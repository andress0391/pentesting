import sys
import os
import urllib.request
from fabrica.otg import OTG
from src.input_validation.Input_validation_testing.inpval_005_template import Inpval_005_template

__otg__ = "OTG-INPVAL-005"

class Invpal_005_PostgreSQL(OTG):

    def __init__(self, url,dependencia=None):
        super().__init__(dependencia, __otg__)
        self.url = url

    def sql_injection(self):
        obj = Inpval_005_template(self.url)
        msg_error = "Query failed: ERROR: syntax error at or near"
        msg_tech = "PostgreSQL"
        payload = "payload_postgreSQL.txt"
        obj.injection(self.url,msg_error,msg_tech,payload)


    def main(self):
        print("================ Iniciando prueba OTG-INPVAL-005-PostgreSQL ==================\n")
        self.sql_injection()
        print("================ Fin prueba OTG-INPVAL-005-PostgreSQL ==================\n")