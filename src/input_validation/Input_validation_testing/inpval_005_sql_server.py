import sys
import os
import urllib.request

from fabrica.otg import OTG
from src.input_validation.Input_validation_testing.inpval_005_template import Inpval_005_template

__otg__ = "OTG-INPVAL-005"

class Invpal_005_Sql_Server(OTG):

    def __init__(self, url,dependencia=None,riesgoNegocio=0.0):
        super().__init__(dependencia, __otg__,riesgoNegocio)
        self.url = url

    def sql_injection(self):
        obj = Inpval_005_template(self.url)
        msg_error = "Microsoft SQL Native Client error"
        msg_tech = "MICROSOFT SQL SERVER"
        payload = "payload_sql_server.txt"
        obj.injection(self.url,msg_error,msg_tech,payload)


    def main(self):
        print("================ Iniciando prueba OTG-INPVAL-005-MS SQL Server ==================\n")
        self.sql_injection()
        print("================ Fin prueba OTG-INPVAL-005-MS SQL Server ==================\n")