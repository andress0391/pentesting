#!/usr/bin/python3
# -*- encoding: utf-8 -*-

import os
import urllib.request
from multiprocessing import Pool
from multiprocessing import Process
from fabrica.otg import OTG
from src.input_validation.Input_validation_testing.inpval_005_template import Inpval_005_template

__otg__ = "OTG-INPVAL-005"

class Invpal_005_MySQL(OTG):

    def __init__(self, url,dependencia=None):
        super().__init__(dependencia, __otg__)
        self.url = url
    
    def sql_injection(self):
        obj = Inpval_005_template(self.url)
        msg_error = "You have an error in your SQL syntax"
        msg_tech = "MySQL"
        payload = "payloadSQL.txt"
        obj.injection(self.url,msg_error,msg_tech,payload)
    
    # def sql_injection_oracle(self):
    #     obj = Inpval_005_template(self.url)
    #     msg_error = "ORA-00933: SQL command not properly ended"
    #     msg_tech = "Oracle"
    #     payload = "payload_oracle.txt"
    #     obj.injection(self.url,msg_error,msg_tech,payload)
    


    def main(self):
        print("================ Iniciando prueba OTG-INPVAL-005-MySQL ==================\n")
        self.sql_injection()
        print("================ Fin prueba OTG-INPVAL-005-MySQL ==================\n")
        # url = "http://www.tunesoman.com/product.php?id="
        # sql_injection(url)
        # parallel = Pool(2)
        # parallel.map(self.command, [process1,process2])

    