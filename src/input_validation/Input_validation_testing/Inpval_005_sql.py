#!/usr/bin/python3
# -*- encoding: utf-8 -*-

import os
import urllib.request
from fabrica.otg import OTG
from src.input_validation.Input_validation_testing.inpval_005_template import Inpval_005_template

__otg__ = "OTG-INPVAL-005"

class Invpal_005_MySQL(OTG):

    def __init__(self, url,dependencia=None):
        super().__init__(dependencia, __otg__)
        self.url = url
    
    def sql_injection(self):
        obj = Inpval_005_template(self.url)
        msg_error = "You have an error in your SQL syntax"
        msg_tech = "MySQL"
        payload = "payloadSQL.txt"
        obj.injection(self.url,msg_error,msg_tech,payload)


    def main(self):
        print("================ Iniciando prueba OTG-INPVAL-005-MySQL ==================\n")
        self.sql_injection()
        print("================ Fin prueba OTG-INPVAL-005-MySQL ==================\n")
        # url = "http://www.tunesoman.com/product.php?id="
        # sql_injection(url)

    