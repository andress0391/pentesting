#!/usr/bin/python3
# -*- encoding: utf-8 -*-

# Python - ClickjackingTester
# Author: Sebastian Neef - Internetwache.org
# Twitter: @internetwache
# Comment: Happy Hacking!

import sys
from urllib.request import urlopen
clickjacking = False

class Client_009(object):
    def __init__(self, url):
        self.url = url
        self.html = ""
        self.complejidad = 1

    def create_poc(self):
        html = '''
    <html>
    <body>
        <iframe src="'''+self.url+'''"></iframe>
    </body>
    </html>
        '''
        self.html =  html

    def is_clickjackable(self):
        url = self.url
        try:
            if url[:4] != "http":
                url = "http://" + url
                sys.argv[1] = url

            req = urlopen(url)
            headers = req.info()

            if not "X-Frame-Options" in headers:
                return True
        except:
            pass
        return False

    def test(self):
        if not self.is_clickjackable():
            return False
        
        self.create_poc()
        return True
    
    def main(self):
        if self.test():
            print("Cbecera X-Frame-Options no encontrada")
            print("Vulnerable a clickjacking")
            print(self.html)
        else:
            print("NO es vulnerable a clickjacking")

#url = "https://simca.unicauca.edu.co/simca/"
#url = "https://github.com"
#a = Client_009(url)
#a.main()
