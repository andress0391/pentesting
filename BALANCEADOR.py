#!/usr/bin/python3
# -*- encoding: utf-8 -*-

class Balancear(object):
    def __init__(self, cpus, procesos=list()):
        self.cpus = cpus
        self.procesos = procesos
        self.resultado = list()

    def main(self):
        # Se ordenan de mayor a menor
        #self.procesos.sort(reverse=False, key=lambda p: p.complejidad)

        tareas = len(self.procesos)
        # Se determina la cantidad de tareas por cpu
        tamBloque = round(tareas/self.cpus)+1

        self.generarBloques()
        self.distribuirProcesos(self.procesos, tamBloque)
    
    def imprimir(self, lista):
        for x in lista:
            print(x.complejidad)
        print("------")
    
    def importarProcesos(self, procesos=None):
        return procesos

    def generarBloques(self):
        for c in range(self.cpus):
            self.resultado.append(list())

    def distribuirProcesos(self, procesos, tamBloque):
        i = 0
        tmp = None
        for p in procesos:
            if len(self.resultado[i]) <= tamBloque:
                if p.dependencia != None:
                    tmp = p.dependencia
                    ii = self.buscarProceso(tmp)
                    self.resultado[ii].append(p)
                else:
                    self.resultado[i].append(p)
                    i += 1
                    i = i%self.cpus
    
    def buscarProceso(self, proceso):
        i = 0
        j = 0
        while i < len(self.resultado):
            while j < len(self.resultado[i]):
                if self.resultado[i][j] == proceso:
                    return i
                j += 1
            j = 0
            i += 1
        return None


#b = Balancear(3)
#b.main()
